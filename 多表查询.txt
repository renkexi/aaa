--  查出至少有一个员工的部门。显示部门编号、部门名称、部门位置、部门人数。
SELECT d.deptno,d.dname,d.loc,e1.`count(*)`
FROM `t_dept` d INNER JOIN (SELECT deptno,COUNT(*) FROM `t_employees` GROUP BY deptno) e1
ON d.deptno=e1.deptno;
-- 列出所有员工的姓名及其直接上级的姓名。
SELECT e.ename 员工姓名,m.ename 上级
FROM `t_employees` e LEFT OUTER JOIN `t_employees` m
ON e.mgr=m.empno;
-- 列出受雇日期早于直接上级的所有员工的编号、姓名、部门名称。
SELECT e1.empno,e1.ename,d.dname
FROM t_employees e1 LEFT OUTER JOIN t_employees e2 ON e1.mgr=e2.empno
LEFT OUTER JOIN t_dept d ON e1.deptno=d.deptno
WHERE e1.hiredate<e2.hiredate;
-- 先不查部门名称，只查部门编号!
SELECT e.empno,e.ename,e.deptno
FROM t_employees e,t_employees m,t_dept d
WHERE e.mgr=m.empno AND e.hiredate<m.hiredate AND e.deptno=d.deptno;
-- 列出部门名称和这些部门的员工信息，同时列出那些没有员工的部门。
SELECT d.dname,e.*
FROM t_dept d LEFT OUTER JOIN t_employees e
ON d.deptno=e.deptno;
-- 列出最低薪金大于15000的各种工作及从事此工作的员工人数
SELECT job,COUNT(*)
FROM t_employees
GROUP BY job
HAVING MIN(sal)>1500;
-- 列出在公关部工作的员工的姓名，假定不知道公关部的部门编号。
SELECT e1.ename
FROM t_employees e1 INNER JOIN t_dept d
ON e1.deptno=d.deptno
WHERE d.dname='公关部'
-- 列出薪金高于公司平均薪金的所有员工信息，所在部门名称，上级领导，工资等级。
SELECT e.*,d.dname,m.ename,s.grade
FROM t_employees e LEFT OUTER JOIN t_dept d ON e.deptno=d.deptno
                  LEFT OUTER JOIN t_employees m ON e.mgr=m.empno
                  LEFT OUTER JOIN salgrade s ON e.sal BETWEEN s.losal AND s.hisal
WHERE e.sal>(SELECT AVG(sal) FROM t_employees);
SELECT * FROM t_employees;
SELECT * FROM t_dept;
SELECT * FROM salgrade;
-- 列出与张飞从事相同工作的所有员工及部门名称。
SELECT e.ename,d.dname
FROM t_employees e INNER JOIN t_dept d
ON e.deptno=d.deptno
WHERE e.job=(SELECT job FROM t_employees WHERE ename='张飞');
-- 列出薪金高于在部门30工作的所有员工的薪金的员工姓名和薪金、部门名称。
SELECT e.ename,e.sal,d.dname
FROM t_employees e LEFT OUTER JOIN t_dept d
ON e.deptno=d.deptno
WHERE e.sal>ALL(SELECT sal FROM t_employees WHERE deptno=30);